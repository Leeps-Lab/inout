<link
    rel="import"
    href="/static/bower_components/polymer/polymer.html" />

<dom-module id="payout-graph">

    <template>
        <style> 
            #graph {
                padding-left: 25%;
                
            }
        </style>
    
            <div id="graph"></div>
    </template>

    <script>
        Polymer({
            is: 'payout-graph',
            properties: {
                treatment: {
                    type: String,
                },
                gameConstant:{
                    type: Number,
                },
                initialValue:{
                    type: Number,
                },
                _personalData: {
                    type: Array,
                    value: [],
                },
                _X_tData: {
                    type: Array,
                    value: [],
                },
                _index: {
                    type: Number,
                    value: 0

                }
            },
            ready() {
                console.log("Graph loaded");
                this.async(this._initChart.bind(this), 1);
                
            },
            _initChart() {
                console.log("initializing graph");
                let series = [
                    {
                        type: 'line',
                        name: "Value (me)",
                        data: this._personalData,
                    },
                    {
                        type: 'line',
                        name: "Stochastic Payout",
                        data: this._X_tData,
                    }
                ];

                this.graph_obj = Highcharts.chart ({
                    chart: {
                        animation: false,
                        renderTo: this.$.graph,
                        width: 500, 
                        height: 500
                    },
                    title: { 
                        text: "",

                    },
                    xAxis: {
                        min: 0,
                        max: 80, // Period length
                        title: {
                            text: 'Period'
                        },
                    },
                    yAxis: {
                        min: 0,
                        max: 300, 
                        title: {
                            text: 'Value'
                        },

                        plotLines: [{
                            color: "#000000",
                            width: 1,
                            value: this.gameConstant,
                            label: {
                                text: (this.gameConstant + " - Q payout"),
                                align: "right",
                                style: {
                                    fontSize: 10,
                                }
                            }
                        }]
                    },
                    credits: {
                        enabled: false
                    },
                    tooltip: {
                        enabled: false
                    },


                    series: series

                });

                
            },
            addPersonalData(dataArr) {


                this._personalData.push(dataArr);
                this.graph_obj.series[0].setData(this._personalData);
                
            },
            addX_tData(dataArr) {
                this._X_tData.push(dataArr);
                this.graph_obj.series[1].setData(this._X_tData);
            },
        });
    </script>
</dom-module>